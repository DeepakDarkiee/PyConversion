{% extends 'base.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}
{% block content %}
<center>
<script src="{% static 'js/celery_progress.js' %}"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  var progressUrl = "{% url 'docum:task_status' task_id %}";
			$(document).ready(function() 
				{
					$("form").submit(function()
					{
						CeleryProgressBar.initProgressBar(progressUrl)
					});
				});
			function customResult(resultElement, result)
			{	
				$( resultElement ).append(
					$('<p>').text('Sum of all seconds is ' + result)
				);
			}
			$(document).ready(function () 
			{
				$("form").submit(function()
				{
				CeleryProgressBar.initProgressBar(progressUrl,
				 	{
						onResult: customResult,
					});
			});
		});
		jQuery(document).ready(function($){

			$("#id_current_choices").click(function()
			{
				var value=$(this).val()
				if (value == "pdf")
				{
					$('#id_file').attr("accept", "." + $(this).val())
				}
				else if (value == "docx")
				{
					$('#id_file').attr("accept", "." + $(this).val())
				}
				else (value == "html")
				{
					$('#id_file').attr("accept", "." + $(this).val())
				}
			});
		});
</script>
	<div class="container-xxl py-6">
		<div class="container">
				<div ">
					<div class="row">
						<div class="col-sm-12">
							<h4 class="text-dark alert alert-secondary">Document Converter</h4>
							<div class="progress-wrapper">
								<div id='progress-bar' class='progress-bar' style="background-color: #6eb672; width: 10px; margin-top:70px">&nbsp;</div>
							</div>
							<div id="progress-bar-message">Waiting for progress to start</div>
							<div id="celery-result"></div>
							<br>
							<div class="col-sm-12">
								<form action="" type=file enctype="multipart/form-data" method="post" style="position: relative; top:20px;">
								{% csrf_token %}
								<div class="row">
									<div class="col-sm-4">
										<b><label for="id_current_choices">Current choices:</label></b> - <select name="current_choices" required id="id_current_choices">
											<option value="" selected>---------</option>
											<option value="pdf">PDF</option>
											<option value="docx">DOCX</option>
											<option value="html">HTML</option>
											</select>
									</div>
									<div class="col-sm-4">
										<b><label for="id_file">File:</label></b> - <input type="file"  accept="" name="file" required id="id_file" onclick="myFunction()"> 
									</div>
									<div class="col-sm-4">
										<b><label for="id_convert_choices">Convert choices:</label></b> - <select name="convert_choices" required id="id_convert_choices">
											<option value="" selected>---------</option>  
											<option value="pdf">PDF</option>
											<option value="docx">DOCX</option>
											<option value="html">HTML</option>
										</select> 
									</div>
									</div>  
								</div>
								<br><br>
									<input type="submit" class="btn btn-primary" value="Convert">
							</form>
						</div>
						</div>
					</div>  
					<br><br><br><br>
					<button type="button"class=" btn btn-default" style="width:300px; margin-left:450px; margin-top:22px;" >{{key}}</button>
				</div>
				</div>
		</div>
	</div>
	</center>
	{% endblock content %}